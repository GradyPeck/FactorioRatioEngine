# FactorioRatioEngine

This project was generated with [Angular CLI](https://github.com/angular/angular-cli) version 8.3.22.

Factorio is a factory-building game in which machines are used to fabricate items. Each item type has its own recipe and time requirements. An item's recipe often includes several different components, and components are themselves items with their own recipes and processing requirements, often nesting several layers deep. Because of this, understanding the actual infrastructure and material costs of manufacturing a particular item can be a complex and time-consuming series of calculations. This app exists to automate every form of this process, allowing the player to focus on strategy.

Most of the functionality of this application is split between three Angular components: numbercruncher, cruncherframe, and csvloader. 
- The csvloader component prepares item recipe data scraped from the Factorio wiki by a Python script written by https://github.com/peckben1, parsing his CSV into JSON. It also cleans the data and handles some special cases. 
- The numbercruncher component is the main body of the calculator and handles most of the processing (more detail on this below). 
- The cruncherframe component mainly facilitates the use of multiple numbercrunchers in parallel, allowing the user to input several item types at once, a common use case. It adds and removes numbercrunchers, and totals their outputs to create a grand total. It also handles some processing for the "ratio-perfect" mode. 

Each numbercruncher operation begins by using recursion to build the recipe hierarchy. The function firstDomino reads the user's inputs, converts their desired products into a temporary recipe and calls the function recurseRecipe. recurseRecipe first searches the recipe bank (provided by the RecipeBankService and populated by csvloader) for the recipe to create its desired item. If it finds it, it calls itself for each component listed in the recipe, returning a list of the returned results. If it does not find a recipe for the given item, it simply returns its inputs as is. This allows the recursion to propagate until every component's recipe has been found, terminating when all components sought are fundamental resources. The ultimate return received by the initial call in firstDomino is a long, very repetitive list of all subcomponents needed, which firstDomino then consolidates and emits to cruncherframe for display. 
